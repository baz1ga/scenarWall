<!DOCTYPE html>
<html lang="fr" class="min-h-screen">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ScenarWall ‚Äì Administration</title>
  <link rel="icon" href="/assets/favicons/favicon.ico" sizes="any">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-touch-icon.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="stylesheet" href="/assets/css/tailwind.css">
  <link rel="stylesheet" href="/assets/fontawesome/css/all.min.css">
  <script src="/js/common/config.js"></script>
  <script src="/js/common/auth.js"></script>
  <script type="module" src="/admin/js/dashboard.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <style>
    @font-face {
      font-family: 'Pangolin';
      src: url('/assets/font/Pangolin-Regular.ttf') format('truetype');
      font-weight: 400;
      font-style: normal;
      font-display: swap;
    }
    .font-pangolin { font-family: 'Pangolin', 'Comic Sans MS', cursive; }
    [x-cloak]{display:none!important}
  </style>
</head>
<body class="min-h-screen h-screen overflow-hidden flex bg-slate-50 text-slate-900 dark:bg-slate-900 dark:text-slate-100">
  <div class="flex h-full w-full bg-slate-50 dark:bg-slate-900">
    <aside class="bg-white dark:bg-slate-950 border-r border-slate-200 dark:border-slate-800 flex flex-col sticky top-0 h-screen transition-all duration-200" :class="sidebarCollapsed ? 'w-19' : 'w-56'">
      <div class="px-3 py-5 flex items-center justify-center">
        <div class="text-3xl font-semibold text-emerald-500 font-pangolin text-center" x-show="!sidebarCollapsed">.ScenarWall.</div>
        <div class="text-xl font-semibold text-emerald-500 font-pangolin" x-show="sidebarCollapsed">.SW.</div>
      </div>
      <nav class="flex-1" :class="sidebarCollapsed ? 'px-1' : 'px-3'">
        <a href="/admin/scenarios/list.html" :class="[
          sidebarCollapsed ? 'justify-center gap-0 px-0' : 'justify-start gap-3 px-3',
          section === 'scenarios' ? 'bg-slate-800 text-amber-300' : 'text-slate-700 dark:text-slate-200 hover:bg-slate-200/70 hover:text-slate-900 dark:hover:bg-slate-800'
        ]" class="w-full flex items-center py-2 rounded-lg text-sm font-medium text-left transition">
          <i class="fa-solid fa-scroll text-base"></i>
          <span x-show="!sidebarCollapsed">Sc√©narios</span>
        </a>
        <div class="space-y-0 mt-0" x-show="!sidebarCollapsed">
          <template x-if="recentScenarios.length === 0">
            <div class="px-3 py-2 text-xs text-slate-500">
              Aucun sc√©nario r√©cent
            </div>
          </template>
          <template x-for="sc in recentScenarios" :key="sc.id">
            <div class="block px-2 py-1 pl-5 rounded-md text-xs text-slate-700 dark:text-slate-200 space-y-1">
              <div class="font-semibold" x-text="sc.title || sc.id"></div>
              <template x-if="Array.isArray(sc.sessions) && sc.sessions.length">
                <div class="space-y-0.5">
                  <template x-for="sessId in sc.sessions.slice(0,3)" :key="sessId">
                    <a :href="`/admin/sessions/view.html?id=${encodeURIComponent(sessId)}`"
                       class="flex items-center gap-1 text-[11px] text-slate-500 dark:text-slate-400 hover:text-amber-400 transition pl-3">
                      <i class="fa-regular fa-circle-dot text-[10px]"></i>
                      <span x-text="lookupSessionTitle(sessId)"></span>
                    </a>
                  </template>
                </div>
              </template>
            </div>
          </template>
        </div>
        <div class="px-2 pt-2" x-show="sidebarCollapsed">
        </div>
        <div class="mt-3 space-y-1">
          <div class="px-3 text-[11px] uppercase tracking-[0.08em] text-slate-500 dark:text-slate-400" x-show="!sidebarCollapsed">Biblioth√®que</div>
          <a href="/admin/gallery/gallery.html" :class="[
            sidebarCollapsed ? 'justify-center gap-0 px-0' : 'justify-start gap-3 px-3',
            section === 'galerie' ? 'bg-slate-800 text-emerald-300' : 'text-slate-700 dark:text-slate-200 hover:bg-slate-200/70 hover:text-slate-900 dark:hover:bg-slate-800'
          ]" class="w-full flex items-center py-2 rounded-lg text-sm font-medium text-left transition">
            <i class="fa-regular fa-image text-base"></i>
            <span x-show="!sidebarCollapsed">Galerie</span>
          </a>
          <a href="/admin/audio/audio.html" :class="[
            sidebarCollapsed ? 'justify-center gap-0 px-0' : 'justify-start gap-3 px-3',
            section === 'audio' ? 'bg-slate-800 text-indigo-300' : 'text-slate-700 dark:text-slate-200 hover:bg-slate-200/70 hover:text-slate-900 dark:hover:bg-slate-800'
          ]" class="w-full flex items-center py-2 rounded-lg text-sm font-medium text-left transition">
            <i class="fa-solid fa-music text-base"></i>
            <span x-show="!sidebarCollapsed">Audio</span>
          </a>
        </div>
        <div class="mt-4 space-y-1" x-show="isSuperAdmin">
          <div class="px-3 text-[11px] uppercase tracking-[0.08em] text-slate-500 dark:text-slate-400" x-show="!sidebarCollapsed">Administration</div>
          <a href="/admin/users/users.html" :class="[
            sidebarCollapsed ? 'justify-center gap-0 px-0' : 'justify-start gap-3 px-3',
            section === 'users' ? 'bg-slate-800 text-amber-300' : 'text-slate-700 dark:text-slate-200 hover:bg-slate-200/70 hover:text-slate-900 dark:hover:bg-slate-800'
          ]" class="w-full flex items-center py-2 rounded-lg text-sm font-medium text-left transition">
            <i class="fa-solid fa-user-gear text-base"></i>
            <span x-show="!sidebarCollapsed">Utilisateurs</span>
          </a>
        </div>
      </nav>
      <div class="px-3 pt-3" x-show="!sidebarCollapsed">
        <div class="p-2 text-center shadow-sm text-sm">
          <p class="text-slate-700 dark:text-slate-300 mb-3">Un coup de pouce pour l'h√©bergement et la üç∫</p>
          <a class="inline-flex items-center justify-center gap-2 rounded-lg bg-emerald-500 text-slate-900 font-semibold px-3 py-2 text-sm hover:bg-emerald-400 transition" href="https://www.buymeacoffee.com/baz1ga" target="_blank" rel="noopener">
            <i class="fa-solid fa-heart"></i> Soutenez-nous
          </a>
        </div>
      </div>
      <div class="px-3 pb-4">
        <button class="w-full inline-flex items-center text-slate-600 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800 transition py-2" :class="sidebarCollapsed ? 'justify-center gap-0' : 'justify-between gap-3 px-3'" @click="toggleSidebar()" :aria-label="sidebarCollapsed ? 'D√©plier la barre lat√©rale' : 'R√©duire la barre lat√©rale'" :title="sidebarCollapsed ? 'D√©plier' : 'R√©duire'">
          <span class="inline-flex items-center gap-2" :class="sidebarCollapsed ? '' : 'flex-1 justify-end'">
            <i :class="sidebarCollapsed ? 'fa-solid fa-angles-right' : 'fa-solid fa-angles-left'"></i>
          </span>
        </button>
      </div>
    </aside>
    <div class="flex-1 flex flex-col h-screen overflow-hidden min-h-0 bg-slate-50 dark:bg-slate-900">
      <header class="flex items-center px-5 py-3 border-b border-slate-200 dark:border-slate-800 bg-white/80 dark:bg-slate-900 backdrop-blur shrink-0">
        <div class="flex-1"></div>
        <div class="hidden md:flex items-center gap-3 justify-center">
          <div class="hidden md:flex items-center gap-2 rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 px-3 py-1.5 text-xs" x-show="tenantId">
            <div class="w-28">
              <div class="text-[11px] text-slate-500 dark:text-slate-400" x-text="quotaDisplay">‚Äî</div>
              <div class="mt-1 h-1.5 w-full rounded-full bg-slate-800 overflow-hidden">
                <div class="h-full bg-emerald-500 transition-all" :style="`width:${quotaPercent}%`"></div>
              </div>
            </div>
          </div>
        </div>
        <div class="flex-1 flex justify-end">
          <div class="flex items-center gap-3">
            <a class="hidden md:inline-flex items-center gap-2 rounded-lg text-center border border-slate-200 dark:border-slate-800 text-slate-700 dark:text-slate-200 font-semibold px-3 py-2 text-sm hover:bg-slate-50 dark:hover:bg-slate-800 transition"
               href="https://tally.so/r/NpqM6N" target="_blank" rel="noopener">
              üé≤ Envie d'am√©liorer .ScenarWall. ?
            </a>
            <button class="p-2 inline-flex items-center justify-center text-slate-700 dark:text-slate-100 hover:text-emerald-500 transition-colors"
                    @click="toggleTheme()"
                    :aria-label="theme === 'dark' ? 'Passer en mode clair' : 'Passer en mode sombre'"
                    :title="theme === 'dark' ? 'Mode clair' : 'Mode sombre'">
              <i :class="theme === 'dark' ? 'fa-regular fa-sun' : 'fa-solid fa-moon'"></i>
            </button>
            <div class="relative" @click.outside="userMenu=false">
              <button class="h-10 w-10 rounded-full bg-emerald-500 text-slate-900 font-semibold flex items-center justify-center hover:bg-emerald-400 overflow-hidden"
                      @click.stop="userMenu = !userMenu">
                <template x-if="avatarUrl">
                  <img :src="avatarUrl" alt="Avatar" class="h-full w-full object-cover">
                </template>
                <template x-if="!avatarUrl">
                  <span class="text-sm font-semibold" x-text="avatarInitial"></span>
                </template>
              </button>
              <div class="absolute right-0 mt-2 w-56 bg-white text-slate-800 dark:bg-slate-800 dark:text-slate-100 rounded-xl border border-slate-200 dark:border-slate-700 shadow-lg z-[9999]" x-show="userMenu" x-transition x-cloak>
                <div class="px-4 py-2 text-xs text-slate-500 dark:text-slate-400 border-b border-slate-200 dark:border-slate-700">
                  Logged as <span class="font-semibold text-slate-800 dark:text-slate-100" x-text="displayName || '‚Äî'"></span>
                </div>
                <a class="block px-4 py-2 text-sm text-slate-700 dark:text-slate-100 hover:bg-slate-100 dark:hover:bg-slate-700" href="https://phserres.notion.site/Roadmap-ScenarWall-2bb25b4f22b780639a41dc03438e4f0c?pvs=73" target="_blank" rel="noopener">
                  <span class="inline-flex items-center gap-2">
                    <i class="fa-solid fa-road"></i>
                    <span>Roadmap .ScenarWall.</span>
                  </span>
                </a>
                <button class="w-full text-left px-4 py-2 text-sm text-rose-600 dark:text-rose-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-b-xl inline-flex items-center gap-2" @click="logout()">
                  <i class="fa-solid fa-arrow-right-from-bracket"></i> <span>Logout</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </header>
      <main class="flex-1 p-4 bg-slate-50 dark:bg-slate-900 overflow-y-auto min-h-0">
        <div class="flex flex-col min-h-full">
          <div class="flex-1">
            {{CONTENT}}
          </div>

          <footer class="dark:bg-slate-900 backdrop-blur px-6 py-4 flex justify-center">
            <div class="w-full max-w-5xl grid gap-3 md:grid-cols-3 items-center text-slate-600 dark:text-slate-300">
              <div class="inline-flex items-center gap-2 text-xs font-semibold text-slate-700 dark:text-slate-200">
                <i class="fa-brands fa-discord"></i><span>Discord</span> : <span>@Baz1ga & @MattBD</span>
              </div>
              <div class="inline-flex items-center justify-center gap-2 font-semibold text-base text-emerald-500 text-center">
                <span><span class="font-pangolin">.ScenarWall.</span> <span class="text-xs"> 2025 B√™ta</span></span> 
              </div>
              <div class="flex items-center justify-end gap-3 flex-wrap text-xs text-emerald-500">
                <a class="hover:text-emerald-400 transition" href="https://phserres.notion.site/Mentions-l-gales-2b625b4f22b780e4852aeeb762578222?pvs=74" target="_blank" rel="noopener">Mentions l√©gales</a>
                <a class="hover:text-emerald-400 transition" href="https://phserres.notion.site/Politique-de-confidentialit-2b625b4f22b780a6b2dce2997443e591?pvs=73"  target="_blank" rel="noopener">Politique de confidentialit√©</a>
                <a class="hover:text-emerald-400 transition" href="https://phserres.notion.site/Conditions-G-n-rales-d-Utilisation-2b825b4f22b780d68ef6c926efa35af8"  target="_blank" rel="noopener">CGU</a>
              </div>
            </div>
          </footer>
        </div>
      </main>
    </div>
  </div>
</body>
</html>
