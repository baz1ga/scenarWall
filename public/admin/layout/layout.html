<!DOCTYPE html>
<html lang="fr" class="min-h-screen">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ScenarWall ‚Äì Administration</title>
  <link rel="icon" href="/assets/favicons/favicon.ico" sizes="any">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-touch-icon.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="stylesheet" href="/assets/css/tailwind.css">
  <link rel="stylesheet" href="/assets/fontawesome/css/all.min.css">
  <script src="/js/common/config.js"></script>
  <script src="/js/common/auth.js"></script>
  <script type="module" src="/admin/js/dashboard.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <style>
    @font-face {
      font-family: 'Pangolin';
      src: url('/assets/font/Pangolin-Regular.ttf') format('truetype');
      font-weight: 400;
      font-style: normal;
      font-display: swap;
    }
    .font-pangolin { font-family: 'Pangolin', 'Comic Sans MS', cursive; }
    [x-cloak]{display:none!important}
  </style>
</head>
<body class="min-h-screen flex bg-slate-50 text-slate-900 dark:bg-slate-900 dark:text-slate-100">
  <div class="flex min-h-screen w-full bg-slate-50 dark:bg-slate-900">
    <aside class="bg-white dark:bg-slate-950 border-r border-slate-200 dark:border-slate-800 flex flex-col sticky top-0 h-screen transition-all duration-200" :class="sidebarCollapsed ? 'w-20' : 'w-64'">
      <div class="px-3 py-5 flex items-center justify-center">
        <div class="text-3xl font-semibold text-emerald-500 font-pangolin text-center" x-show="!sidebarCollapsed">.ScenarWall.</div>
        <div class="text-xl font-semibold text-emerald-500 font-pangolin" x-show="sidebarCollapsed">.SW.</div>
      </div>
      <nav class="flex-1 space-y-2" :class="sidebarCollapsed ? 'px-1' : 'px-3'">
        <a href="/admin/scenarios/list.html" :class="[
          sidebarCollapsed ? 'justify-center gap-0 px-0' : 'justify-start gap-3 px-3',
          section === 'scenarios' ? 'bg-slate-800 text-amber-300' : 'text-slate-700 dark:text-slate-200 hover:bg-slate-200/70 hover:text-slate-900 dark:hover:bg-slate-800'
        ]" class="w-full flex items-center py-2 rounded-lg text-sm font-medium text-left transition">
          <i class="fa-solid fa-scroll text-base"></i>
          <span x-show="!sidebarCollapsed">Sc√©narios</span>
        </a>
        <div class="space-y-1" x-show="!sidebarCollapsed">
          <template x-if="recentScenarios.length === 0">
            <div class="text-xs text-slate-400 px-2">‚Äî</div>
          </template>
          <template x-for="sc in recentScenarios" :key="sc.id">
            <div class="block px-2 py-1 rounded-md text-xs text-slate-700 dark:text-slate-200 space-y-1">
              <div class="font-semibold" x-text="sc.title || sc.id"></div>
              <template x-if="Array.isArray(sc.sessions) && sc.sessions.length">
                <div class="space-y-0.5">
                  <template x-for="sessId in sc.sessions.slice(0,3)" :key="sessId">
                    <a :href="`/admin/sessions/view.html?id=${encodeURIComponent(sessId)}`"
                       class="flex items-center gap-1 text-[11px] text-slate-500 dark:text-slate-400 hover:text-amber-400 transition pl-3">
                      <i class="fa-regular fa-circle-dot text-[10px]"></i>
                      <span x-text="lookupSessionTitle(sessId)"></span>
                    </a>
                  </template>
                </div>
              </template>
            </div>
          </template>
        </div>
        <div class="px-2 pt-2" x-show="sidebarCollapsed">
        </div>
        <a href="/admin/gallery/gallery.html" :class="[
          sidebarCollapsed ? 'justify-center gap-0 px-0' : 'justify-start gap-3 px-3',
          section === 'galerie' ? 'bg-slate-800 text-emerald-300' : 'text-slate-700 dark:text-slate-200 hover:bg-slate-200/70 hover:text-slate-900 dark:hover:bg-slate-800'
        ]" class="w-full flex items-center py-2 rounded-lg text-sm font-medium text-left transition mt-2">
          <i class="fa-regular fa-image text-base"></i>
          <span x-show="!sidebarCollapsed">Galerie</span>
        </a>
      </nav>
      <div class="px-4 py-4 text-xs text-slate-500 space-y-3" x-show="!sidebarCollapsed">
        <div class="rounded-xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-4 text-center shadow-sm text-sm">
          <div class="flex items-center gap-2 text-emerald-500 font-semibold uppercase tracking-[0.08em] text-xs mb-1"></div>
          <p class="text-slate-700 dark:text-slate-300 mb-3">Un coup de pouce pour l'h√©bergement et la üç∫</p>
          <a class="inline-flex items-center justify-center gap-2 rounded-lg bg-emerald-500 text-slate-900 font-semibold px-3 py-2 text-sm hover:bg-emerald-400 transition" href="https://www.buymeacoffee.com/baz1ga" target="_blank" rel="noopener">
            <i class="fa-solid fa-heart"></i> Soutenez-nous
          </a>
        </div>
        <a class="inline-flex w-full items-center justify-center gap-2 rounded-lg text-center border border-slate-200 dark:border-slate-800 text-slate-700 dark:text-slate-200 font-semibold px-3 py-2 text-sm hover:bg-slate-50 dark:hover:bg-slate-800 transition" href="https://tally.so/r/NpqM6N" target="_blank" rel="noopener">
          üé≤ Envie d'am√©liorer .ScenarWall. ?
        </a>
        <footer class="sw-legal-footer mt-2 text-center text-xs leading-6 text-slate-500 dark:text-slate-400 space-y-1">
          <div class="text-base font-semibold text-emerald-500 font-pangolin">.ScenarWall. 2025 B√™ta</div>
          <div class="author uppercase tracking-[0.06em] font-semibold text-slate-700 dark:text-slate-300">
            @Baz1ga & @MattBD<i class="fa-brands fa-discord"></i> Discord)
          </div>
          <div class="links inline-flex flex-wrap gap-3 items-center justify-center">
            <a class="text-emerald-500 hover:text-emerald-400 transition" href="https://phserres.notion.site/Mentions-l-gales-2b625b4f22b780e4852aeeb762578222?pvs=74" target="_blank" rel="noopener">Mentions l√©gales</a>
            <a class="text-emerald-500 hover:text-emerald-400 transition" href="https://phserres.notion.site/Politique-de-confidentialit-2b625b4f22b780a6b2dce2997443e591?pvs=73"  target="_blank" rel="noopener">Politique de confidentialit√©</a>
            <a class="text-emerald-500 hover:text-emerald-400 transition" href="https://phserres.notion.site/Conditions-G-n-rales-d-Utilisation-2b825b4f22b780d68ef6c926efa35af8"  target="_blank" rel="noopener">CGU</a>
          </div>
        </footer>
      </div>
      <div class="px-3 pb-4">
        <button class="w-full inline-flex items-center text-slate-600 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800 transition py-2" :class="sidebarCollapsed ? 'justify-center gap-0' : 'justify-between gap-3 px-3'" @click="toggleSidebar()" :aria-label="sidebarCollapsed ? 'D√©plier la barre lat√©rale' : 'R√©duire la barre lat√©rale'" :title="sidebarCollapsed ? 'D√©plier' : 'R√©duire'">
          <span class="inline-flex items-center gap-2" :class="sidebarCollapsed ? '' : 'flex-1 justify-end'">
            <i :class="sidebarCollapsed ? 'fa-solid fa-angles-right' : 'fa-solid fa-angles-left'"></i>
          </span>
        </button>
      </div>
    </aside>
    <div class="flex-1 flex flex-col min-h-screen bg-slate-50 dark:bg-slate-900">
      <header class="flex items-center px-6 py-4 border-b border-slate-200 dark:border-slate-800 bg-white/80 dark:bg-slate-900 backdrop-blur">
        <div class="flex-1"></div>
        <div class="hidden md:flex items-center gap-3 justify-center">
          <div class="hidden md:flex items-center gap-2 rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 px-3 py-1.5 text-xs" x-show="tenantId">
            <div class="w-28">
              <div class="text-[11px] text-slate-500 dark:text-slate-400" x-text="quotaDisplay">‚Äî</div>
              <div class="mt-1 h-1.5 w-full rounded-full bg-slate-800 overflow-hidden">
                <div class="h-full bg-emerald-500 transition-all" :style="`width:${quotaPercent}%`"></div>
              </div>
            </div>
          </div>
          <button class="hidden md:inline-flex items-center gap-3 rounded-lg border border-emerald-500 bg-emerald-500 text-slate-900 font-semibold px-5 py-2.5 text-sm hover:bg-emerald-400 dark:bg-slate-950 dark:border-slate-800 dark:text-emerald-200 dark:hover:bg-slate-800" @click="openFront" x-show="section === 'gm'">
            <i class="fa-solid fa-film"></i> Pr√©senter
          </button>
        </div>
        <div class="flex-1 flex justify-end">
          <div class="flex items-center gap-3">
            <button class="p-2 inline-flex items-center justify-center text-slate-700 dark:text-slate-100 hover:text-emerald-500 transition-colors"
                    @click="toggleTheme()"
                    :aria-label="theme === 'dark' ? 'Passer en mode clair' : 'Passer en mode sombre'"
                    :title="theme === 'dark' ? 'Mode clair' : 'Mode sombre'">
              <i :class="theme === 'dark' ? 'fa-regular fa-sun' : 'fa-solid fa-moon'"></i>
            </button>
            <div class="relative" @click.outside="userMenu=false">
              <button class="h-10 w-10 rounded-full bg-emerald-500 text-slate-900 font-semibold flex items-center justify-center hover:bg-emerald-400 overflow-hidden"
                      @click.stop="userMenu = !userMenu">
                <template x-if="avatarUrl">
                  <img :src="avatarUrl" alt="Avatar" class="h-full w-full object-cover">
                </template>
                <template x-if="!avatarUrl">
                  <span class="text-sm font-semibold" x-text="avatarInitial"></span>
                </template>
              </button>
              <div class="absolute right-0 mt-2 w-56 bg-white text-slate-800 dark:bg-slate-800 dark:text-slate-100 rounded-xl border border-slate-200 dark:border-slate-700 shadow-lg" x-show="userMenu" x-transition x-cloak>
                <div class="px-4 py-2 text-xs text-slate-500 dark:text-slate-400 border-b border-slate-200 dark:border-slate-700">
                  Logged as <span class="font-semibold text-slate-800 dark:text-slate-100" x-text="displayName || '‚Äî'"></span>
                </div>
                <a class="block px-4 py-2 text-sm text-slate-700 dark:text-slate-100 hover:bg-slate-100 dark:hover:bg-slate-700" href="https://phserres.notion.site/Roadmap-ScenarWall-2bb25b4f22b780639a41dc03438e4f0c?pvs=73" target="_blank" rel="noopener">
                  <span class="inline-flex items-center gap-2">
                    <i class="fa-solid fa-road"></i>
                    <span>Roadmap .ScenarWall.</span>
                  </span>
                </a>
                <button class="w-full text-left px-4 py-2 text-sm text-rose-600 dark:text-rose-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-b-xl inline-flex items-center gap-2" @click="logout()">
                  <i class="fa-solid fa-arrow-right-from-bracket"></i> <span>Logout</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </header>
      <main class="flex-1 p-6 bg-slate-50 dark:bg-slate-900">
        {{CONTENT}}
      </main>
    </div>
  </div>
</body>
</html>
